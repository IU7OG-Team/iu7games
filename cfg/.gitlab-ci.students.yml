stages:
  - build

variables:
  COMPILE_FLAGS: -Werror -Wall -Wextra -Wpedantic -Wcast-align -Wcast-qual
    -Wconversion  -Wenum-compare -Wfloat-equal  -Wredundant-decls -Wsign-conversion -c
  XOGAME_PATH: XOgame/
  STRGAME_PATH: STRgame/
  TEEN48GAME_PATH: TEEN48game/

strgame:
  stage: build
  image: hackfeed/iu7games
  script:
    - gcc ${COMPILE_FLAGS} -fpic ${STRGAME_PATH}${GITLAB_USER_LOGIN}_split.c || true
    - gcc ${COMPILE_FLAGS} -fpic ${STRGAME_PATH}${GITLAB_USER_LOGIN}_strtok.c || true
    - gcc -shared -o ${GITLAB_USER_LOGIN}_split_lib.so ${GITLAB_USER_LOGIN}_split.o || true
    - gcc -shared -o ${GITLAB_USER_LOGIN}_strtok_lib.so ${GITLAB_USER_LOGIN}_strtok.o || true
  after_script:
    - rm -f *.o
  artifacts:
    paths:
      - ./*.so
  only:
    refs:
      - STRgame
